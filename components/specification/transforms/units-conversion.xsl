<?xml version="1.0" encoding="UTF-8"?>
<!--
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#
# Copyright (C) 2014 Open Microscopy Environment
#       Massachusetts Institute of Technology,
#       National Institutes of Health,
#       University of Dundee,
#       University of Wisconsin at Madison
#
#    This library is free software; you can redistribute it and/or
#    modify it under the terms of the GNU Lesser General Public
#    License as published by the Free Software Foundation; either
#    version 2.1 of the License, or (at your option) any later version.
#
#    This library is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
#    Lesser General Public License for more details.
#
#    You should have received a copy of the GNU Lesser General Public
#    License along with this library; if not, write to the Free Software
#    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
--><!--
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Written by:  Andrew Patterson: ajpatterson at lifesci.dundee.ac.uk
# Generated by: templates/xsd. Please do not edit!
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
--><xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:math="http://exslt.org/math" exclude-result-prefixes="xs" version="2.0">
	<!-- getDefault function (AttributeName, NodeName, ParentNodeName?) -->
	<!-- 	returns the default as string -->
	<xsl:template name="GetDefaultUnit">
		<xsl:param name="theAttributeName"/>
		<xsl:param name="theElementName"/>
		<xsl:choose>
			<!-- codegen begin - defaults -->
			<xsl:when test="$theAttributeName = 'EmissionWavelength' and $theElementName = 'Channel'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'ExcitationWavelength' and $theElementName = 'Channel'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'PinholeSize' and $theElementName = 'Channel'">µm</xsl:when>
			<xsl:when test="$theAttributeName = 'Voltage' and $theElementName = 'Detector'">V</xsl:when>
			<xsl:when test="$theAttributeName = 'ReadOutRate' and $theElementName = 'DetectorSettings'">MHz</xsl:when>
			<xsl:when test="$theAttributeName = 'Voltage' and $theElementName = 'DetectorSettings'">V</xsl:when>
			<xsl:when test="$theAttributeName = 'AirPressure' and $theElementName = 'ImagingEnvironment'">mbar</xsl:when>
			<xsl:when test="$theAttributeName = 'Temperature' and $theElementName = 'ImagingEnvironment'">°C</xsl:when>
			<xsl:when test="$theAttributeName = 'RepetitionRate' and $theElementName = 'Laser'">Hz</xsl:when>
			<xsl:when test="$theAttributeName = 'Wavelength' and $theElementName = 'Laser'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'Power' and $theElementName = 'LightSource'">mW</xsl:when>
			<xsl:when test="$theAttributeName = 'Wavelength' and $theElementName = 'LightSourceSettings'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'WorkingDistance' and $theElementName = 'Objective'">µm</xsl:when>
			<xsl:when test="$theAttributeName = 'PhysicalSizeX' and $theElementName = 'Pixels'">µm</xsl:when>
			<xsl:when test="$theAttributeName = 'PhysicalSizeY' and $theElementName = 'Pixels'">µm</xsl:when>
			<xsl:when test="$theAttributeName = 'PhysicalSizeZ' and $theElementName = 'Pixels'">µm</xsl:when>
			<xsl:when test="$theAttributeName = 'TimeIncrement' and $theElementName = 'Pixels'">s</xsl:when>
			<xsl:when test="$theAttributeName = 'DeltaT' and $theElementName = 'Plane'">s</xsl:when>
			<xsl:when test="$theAttributeName = 'ExposureTime' and $theElementName = 'Plane'">s</xsl:when>
			<xsl:when test="$theAttributeName = 'PositionX' and $theElementName = 'Plane'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'PositionY' and $theElementName = 'Plane'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'PositionZ' and $theElementName = 'Plane'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'WellOriginX' and $theElementName = 'Plate'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'WellOriginY' and $theElementName = 'Plate'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'FontSize' and $theElementName = 'Shape'">pt</xsl:when>
			<xsl:when test="$theAttributeName = 'StrokeWidth' and $theElementName = 'Shape'">pixel</xsl:when>
			<xsl:when test="$theAttributeName = 'X' and $theElementName = 'StageLabel'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'Y' and $theElementName = 'StageLabel'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'Z' and $theElementName = 'StageLabel'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'CutIn' and $theElementName = 'TransmittanceRange'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'CutInTolerance' and $theElementName = 'TransmittanceRange'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'CutOut' and $theElementName = 'TransmittanceRange'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'CutOutTolerance' and $theElementName = 'TransmittanceRange'">nm</xsl:when>
			<xsl:when test="$theAttributeName = 'PositionX' and $theElementName = 'WellSample'">reference frame</xsl:when>
			<xsl:when test="$theAttributeName = 'PositionY' and $theElementName = 'WellSample'">reference frame</xsl:when>
			<!-- codegen end - defaults -->
			<xsl:otherwise>
				<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - GetDefaultUnit, the default for [<xsl:value-of select="$theAttributeName"/>] in element [<xsl:value-of select="$theElementName"/>] is not supported.</xsl:message>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<!-- 	returns the value in the default units -->
	<!-- 	error and terminate if conversion not possible e.g. pixel->nm -->
	<xsl:template name="ConvertValueToDefault">
		<xsl:param name="theValue"/>
		<xsl:param name="theCurrentUnit"/>
		<xsl:param name="theAttributeName"/>
		<xsl:param name="theElementName"/>
		<xsl:message>OME-XSLT: units-conversion.xsl - Message - ConvertValueToDefault, (<xsl:value-of select="$theValue"/>, <xsl:value-of select="$theCurrentUnit"/>, <xsl:value-of select="$theAttributeName"/>, <xsl:value-of select="$theElementName"/>).</xsl:message>
		<xsl:choose>
			<xsl:when test="$theCurrentUnit = ''">
				<!-- Already using default units so no conversion necessary -->
				<xsl:value-of select="$theValue"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:call-template name="ConvertValueToUnit">
					<xsl:with-param name="theValue"><xsl:value-of select="$theValue"/></xsl:with-param>
					<xsl:with-param name="theCurrentUnit"><xsl:value-of select="$theCurrentUnit"/></xsl:with-param>
					<xsl:with-param name="theNewUnit">
						<xsl:call-template name="GetDefaultUnit">
							<xsl:with-param name="theAttributeName"><xsl:value-of select="$theAttributeName"/></xsl:with-param>
							<xsl:with-param name="theElementName"><xsl:value-of select="$theElementName"/></xsl:with-param>
						</xsl:call-template>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="ConvertValueToUnit">
		<xsl:param name="theValue"/>
		<xsl:param name="theCurrentUnit"/>
		<xsl:param name="theNewUnit"/>
		<xsl:choose>
			<xsl:when test="$theNewUnit = ''">
				<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion of [<xsl:value-of select="$theCurrentUnit"/>] to an unknown unit.</xsl:message>
			</xsl:when>
			<xsl:when test="$theNewUnit = $theCurrentUnit"><xsl:value-of select="$theValue"/></xsl:when>
			<!-- codegen begin - convert -->
			<xsl:when test="$theCurrentUnit = 'YV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ZV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'EV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'PV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'TV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'GV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'MV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'kV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'daV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'V'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'nV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'aV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yV'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'yV'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YV'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZV'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EV'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PV'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TV'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GV'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MV'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kV'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hV'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daV'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'V'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dV'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cV'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mV'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µV'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nV'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pV'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fV'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aV'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zV'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'YHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ZHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'EHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'PHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'THz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'GHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'MHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'kHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'daHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Hz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'nHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'aHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yHz'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'yHz'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YHz'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZHz'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EHz'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PHz'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'THz'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GHz'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MHz'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kHz'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hHz'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daHz'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Hz'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dHz'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cHz'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mHz'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µHz'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nHz'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pHz'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fHz'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aHz'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zHz'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Ym'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 34))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (625*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 30)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 28)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 27)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 25)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 25)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 28)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Zm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 31))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (625*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 27)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 25)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 24)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 25)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Em'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 28))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (625*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 24)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Pm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (625*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Tm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (625*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Gm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (78125*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Mm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'km'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (125*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dam'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'nm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((254*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((254*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'am'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((254*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((254*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ym'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((254*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Å'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(math:power(10, 34)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(math:power(10, 31)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(math:power(10, 28)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((94607304725808*math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="((30856776*math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(((635*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((254*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((3048*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((9144*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((1609344*math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="(((3175*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ua'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ly'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((625*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((625*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((625*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((625*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((625*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 26)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (94607304725808*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((6428495*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (47303652362904*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (567643828354848*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (47303652362904*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (3941971030242*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (1313990343414*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (3405862970129088*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pc'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((125*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((125*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((125*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 24)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 27)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 30)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 33)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (30856776*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / (6428495*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (15428388*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / (185140656*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / (15428388*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / (1285699*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / (1285699*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((math:power(10, None) / (803561875*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / (1110843936*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'thou'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((5*math:power(10, 30)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((5*math:power(10, 27)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((5*math:power(10, 24)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((5*math:power(10, 21)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((5*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((5*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((5*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((5*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(((5*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(((5*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(((5*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="(((5*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="(((5*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((47303652362904*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((15428388*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="((6336*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'li'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((6*math:power(10, 28)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((6*math:power(10, 25)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((6*math:power(10, 22)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((6*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((6*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((6*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((6*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((6*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(((6*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(((6*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(((6*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (635*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((567643828354848*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((185140656*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'in'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((5*math:power(10, 27)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((5*math:power(10, 24)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((5*math:power(10, 21)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((5*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((5*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((5*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((5*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((5*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(((5*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(((5*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (254*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((47303652362904*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((15428388*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ft'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((125*math:power(10, 25)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((125*math:power(10, 22)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((125*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((125*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((125*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((125*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((125*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((125*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (3048*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((3941971030242*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((1285699*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'yd'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((125*math:power(10, 25)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((125*math:power(10, 22)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((125*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((125*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((125*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((125*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((125*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((125*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (9144*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((1313990343414*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((1285699*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mi'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((78125*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((78125*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((78125*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((78125*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((78125*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((78125*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (1609344*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((803561875*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / (6336*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pt'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pt'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ym'"><xsl:value-of select="(((36*math:power(10, 28)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zm'"><xsl:value-of select="(((36*math:power(10, 25)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Em'"><xsl:value-of select="(((36*math:power(10, 22)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Pm'"><xsl:value-of select="(((36*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Tm'"><xsl:value-of select="(((36*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gm'"><xsl:value-of select="(((36*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mm'"><xsl:value-of select="(((36*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'km'"><xsl:value-of select="(((36*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hm'"><xsl:value-of select="(((36*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dam'"><xsl:value-of select="(((36*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'm'"><xsl:value-of select="(((36*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nm'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pm'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fm'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'am'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zm'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ym'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Å'"><xsl:value-of select="((math:power(10, None) / (3175*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ly'"><xsl:value-of select="(((3405862970129088*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pc'"><xsl:value-of select="(((1110843936*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'thou'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'li'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'in'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ft'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pixel'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'reference frame'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'YW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ZW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'EW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'PW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'TW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'GW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'MW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'kW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'daW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'W'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'nW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'aW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yW'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'yW'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YW'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZW'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EW'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PW'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TW'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GW'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MW'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kW'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hW'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daW'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'W'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dW'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cW'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mW'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µW'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nW'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pW'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fW'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aW'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zW'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'YPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 33)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 26)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 32)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ZPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 30)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 29)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'EPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 27)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 26)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'PPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 24)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'TPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'GPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'MPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'kPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="$theValue"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="$theValue"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'daPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Pa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'nPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'pPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="(((2533125*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((689475729316836*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="(((2533125*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((133322387415*math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'aPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 29)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((689475729316836*math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="(((2533125*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((133322387415*math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 32)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 29)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((689475729316836*math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="(((2533125*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((133322387415*math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'yPa'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, 29)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 35)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 32)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, 28)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((689475729316836*math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((2533125*math:power(10, 21)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="(((2533125*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((133322387415*math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'bar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 29))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Mbar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 29))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 32))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 35))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'kbar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 29))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 32))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'dbar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 28))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cbar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="$theValue"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mbar'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="$theValue"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / (304*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (2*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'atm'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'psi'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(((25*math:power(10, 33)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(((25*math:power(10, 30)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(((25*math:power(10, 27)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(((25*math:power(10, 24)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(((25*math:power(10, 21)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(((25*math:power(10, 18)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(((25*math:power(10, 15)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(((25*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(((25*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(((25*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(((25*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(((25*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(((25*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / (689475729316836*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / (689475729316836*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / (689475729316836*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / (689475729316836*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(((25*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(((25*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(((25*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(((25*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(((25*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(((25*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((3015625*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Torr'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(((304*math:power(10, 23)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(((304*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(((304*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(((304*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(((304*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(((304*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(((304*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 21)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(((304*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(((304*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(((304*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / (3015625*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / (24125*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mTorr'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(((304*math:power(10, 26)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(((304*math:power(10, 23)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(((304*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(((304*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(((304*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(((304*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(((304*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(((304*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(((304*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / (2533125*math:power(10, 18)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(((304*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(((304*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(((304*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(((304*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(((304*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(((304*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mm Hg'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'mm Hg'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'YPa'"><xsl:value-of select="(((2*math:power(10, 32)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ZPa'"><xsl:value-of select="(((2*math:power(10, 29)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'EPa'"><xsl:value-of select="(((2*math:power(10, 26)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'PPa'"><xsl:value-of select="(((2*math:power(10, 23)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'TPa'"><xsl:value-of select="(((2*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'GPa'"><xsl:value-of select="(((2*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'MPa'"><xsl:value-of select="(((2*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kPa'"><xsl:value-of select="(((2*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hPa'"><xsl:value-of select="(((2*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'daPa'"><xsl:value-of select="(((2*math:power(10, 9)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dPa'"><xsl:value-of select="(((2*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cPa'"><xsl:value-of select="(((2*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mPa'"><xsl:value-of select="(((2*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'nPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'pPa'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fPa'"><xsl:value-of select="((math:power(10, None) / (133322387415*math:power(10, 6)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'aPa'"><xsl:value-of select="((math:power(10, None) / (133322387415*math:power(10, 9)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zPa'"><xsl:value-of select="((math:power(10, None) / (133322387415*math:power(10, 12)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'yPa'"><xsl:value-of select="((math:power(10, None) / (133322387415*math:power(10, 15)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'bar'"><xsl:value-of select="(((2*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Mbar'"><xsl:value-of select="(((2*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'kbar'"><xsl:value-of select="(((2*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'dbar'"><xsl:value-of select="(((2*math:power(10, 12)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cbar'"><xsl:value-of select="(((2*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mbar'"><xsl:value-of select="(((2*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'psi'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Torr'"><xsl:value-of select="(((24125*math:power(10, 6)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'mTorr'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'K'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = '°C'"><xsl:value-of select="($theValue+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°F'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°R'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'K'"><xsl:value-of select="($theValue+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°F'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+math:power(10, None))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°R'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = '°F'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'K'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°C'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°R'"><xsl:value-of select="($theValue+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = '°R'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'K'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = '°C'"><xsl:value-of select="(((math:power(10, None) / math:power(10, None))*$theValue)+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:when test="$theNewUnit = '°F'"><xsl:value-of select="($theValue+(math:power(10, None) / math:power(10, None)))"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Ys'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 48))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 20)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / (3125*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Zs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 45))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 19)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / (3125*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Es'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 42))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / (3125*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Ps'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 39))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / (3125*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Ts'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 36))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / (3125*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Gs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 33))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / (25*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'Ms'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 30))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / (5*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ks'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 27))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'hs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'das'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 's'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 24))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ds'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 20))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'cs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 19))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ms'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 21))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 4))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 5))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'µs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 5)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 4)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 18))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 7))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 8))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ns'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 8)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 7)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 15))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 10))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 11))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ps'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 11)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 10)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 12))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 13))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 14))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'fs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 17)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 16)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 14)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 13)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / math:power(10, 6))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, 9))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 16))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 17))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'as'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'zs'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 20)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 19)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="(math:power(10, 6)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 22))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 23))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'ys'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(math:power(10, 48)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(math:power(10, 45)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(math:power(10, 42)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(math:power(10, 39)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(math:power(10, 36)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(math:power(10, 33)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(math:power(10, 30)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="(math:power(10, 27)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="(math:power(10, 26)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="(math:power(10, 25)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="(math:power(10, 24)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="(math:power(10, 23)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="(math:power(10, 22)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="(math:power(10, 21)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="(math:power(10, 18)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="(math:power(10, 15)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="(math:power(10, 12)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="(math:power(10, 9)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((6*math:power(10, 25))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((36*math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="((864*math:power(10, 26))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'min'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(((5*math:power(10, 22)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(((5*math:power(10, 19)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(((5*math:power(10, 16)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(((5*math:power(10, 13)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(((5*math:power(10, 10)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(((5*math:power(10, 7)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="(((5*math:power(10, 4)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 7)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 10)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 13)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 16)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 22)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / (6*math:power(10, 25)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'h'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(((25*math:power(10, 20)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(((25*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(((25*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(((25*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(((25*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="(((25*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / (36*math:power(10, 26)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'd'"><xsl:value-of select="(math:power(10, None)*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theCurrentUnit = 'd'">
				<xsl:choose>
					<xsl:when test="$theNewUnit = 'UNKNOWN%SYMBOL'"><xsl:value-of select="ERROR"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ys'"><xsl:value-of select="(((3125*math:power(10, 17)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Zs'"><xsl:value-of select="(((3125*math:power(10, 14)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Es'"><xsl:value-of select="(((3125*math:power(10, 11)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ps'"><xsl:value-of select="(((3125*math:power(10, 8)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ts'"><xsl:value-of select="(((3125*math:power(10, 5)) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Gs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'Ms'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ks'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'hs'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'das'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 's'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ds'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'cs'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 4)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ms'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 5)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'µs'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 8)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ns'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 11)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ps'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 14)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'fs'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 17)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'zs'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 23)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'ys'"><xsl:value-of select="((math:power(10, None) / (864*math:power(10, 26)))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'min'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:when test="$theNewUnit = 'h'"><xsl:value-of select="((math:power(10, None) / math:power(10, None))*$theValue)"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$theNewUnit = '°C'">
				<xsl:choose>
					<xsl:when test="$theCurrentUnit = '°F'"><xsl:value-of select="(($theValue - 32) * 5) div 9"/></xsl:when>
					<xsl:otherwise>
						<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion, [<xsl:value-of select="$theCurrentUnit"/>] to [<xsl:value-of select="$theNewUnit"/>] is not supported.</xsl:message>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<!-- codegen end - convert -->
			<xsl:otherwise>
				<xsl:message terminate="yes">OME-XSLT: units-conversion.xsl - ERROR - ConvertValueToUnit, cannot perform conversion from any unit to [<xsl:value-of select="$theNewUnit"/>].</xsl:message>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet>
